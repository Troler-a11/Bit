<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZENITH | Multi-Terminal</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #050608; --accent: #00ff88; --border: rgba(0, 255, 136, 0.2); }
        body { background: var(--bg); color: white; font-family: 'JetBrains Mono', monospace; margin: 0; padding-bottom: 50px; }
        
        .top-nav {
            position: sticky; top: 0; background: rgba(5, 6, 8, 0.9);
            backdrop-filter: blur(15px); padding: 15px 25px;
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid var(--border); z-index: 100;
        }

        .select-ui {
            background: #000; color: var(--accent); border: 1px solid var(--accent);
            padding: 8px; border-radius: 5px; font-family: inherit; cursor: pointer;
        }

        .container { max-width: 1200px; margin: auto; padding: 30px 20px; }
        
        .market-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;
        }

        .card {
            background: rgba(255,255,255,0.02); border: 1px solid var(--border);
            border-radius: 15px; padding: 20px; transition: 0.3s;
        }
        .card:hover { background: rgba(0, 255, 136, 0.03); border-color: var(--accent); }

        .price-text { font-size: 26px; font-weight: bold; margin: 10px 0; letter-spacing: -1px; }
        .symbol { color: #555; font-size: 12px; margin-bottom: 5px; display: block; }
        
        canvas { max-height: 80px; margin-top: 15px; pointer-events: none; }

        .pulse {
            width: 8px; height: 8px; background: var(--accent); border-radius: 50%;
            display: inline-block; margin-right: 10px; box-shadow: 0 0 10px var(--accent);
            animation: blink 1s infinite;
        }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.2; } }
    </style>
</head>
<body>

    <div class="top-nav">
        <div style="font-weight:bold; letter-spacing:2px; font-size:20px;">ZENITH<span>.OS</span></div>
        <div>
            <span style="font-size:10px; color:#666; margin-right:10px;">ГОЛОВНА ВАЛЮТА:</span>
            <select id="baseCurr" class="select-ui" onchange="resetAndRefresh()">
                <option value="uah">UAH ₴</option>
                <option value="usd">USD $</option>
                <option value="eur">EUR €</option>
                <option value="rub">RUB ₽</option>
            </select>
        </div>
    </div>

    <div class="container">
        <div style="margin-bottom:30px;">
            <div class="pulse"></div>
            <span style="font-size:11px; color:var(--accent);">LIVE DATA STREAM / UPDATE: 3S</span>
        </div>

        <div class="market-grid" id="grid">
            </div>
    </div>

    <script>
        // Список активів: Крипта + Фіат (через крос-курси)
        const assets = [
            {id: 'bitcoin', name: 'BITCOIN', type: 'crypto'},
            {id: 'ethereum', name: 'ETHEREUM', type: 'crypto'},
            {id: 'usd', name: 'US DOLLAR', type: 'fiat'},
            {id: 'eur', name: 'EURO', type: 'fiat'},
            {id: 'rub', name: 'RUS RUBLE', type: 'fiat'},
            {id: 'uah', name: 'UKR HRYVNIA', type: 'fiat'}
        ];

        const charts = {};
        let currentPrices = {};

        function initCards() {
            const grid = document.getElementById('grid');
            const base = document.getElementById('baseCurr').value;
            
            grid.innerHTML = assets.filter(a => a.id !== base).map(a => `
                <div class="card">
                    <span class="symbol">${a.name} / ${base.toUpperCase()}</span>
                    <div id="prc-${a.id}" class="price-text">0.00</div>
                    <canvas id="chart-${a.id}"></canvas>
                </div>
            `).join('');

            assets.filter(a => a.id !== base).forEach(a => {
                const ctx = document.getElementById(`chart-${a.id}`).getContext('2d');
                charts[a.id] = new Chart(ctx, {
                    type: 'line',
                    data: { labels: Array(15).fill(''), datasets: [{ 
                        data: [], borderColor: '#00ff88', borderWidth: 1.5, tension: 0.3, pointRadius: 0, fill: true,
                        backgroundColor: 'rgba(0, 255, 136, 0.05)'
                    }]},
                    options: { plugins: { legend: { display: false } }, scales: { x: { display: false }, y: { display: false } } }
                });
            });
        }

        async function update() {
            const base = document.getElementById('baseCurr').value;
            try {
                // Отримуємо крипту і валюти (через API CoinGecko, воно вміє в крос-курси)
                const res = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,tether,binancecoin&vs_currencies=usd,eur,uah,rub`);
                const data = await res.json();
                
                // Отримуємо фіатні курси через стейблкоїн (Tether) як міст
                const fiatBridge = data['tether']; 

                assets.forEach(a => {
                    if(a.id === base) return;
                    
                    let price;
                    if(a.type === 'crypto') {
                        price = data[a.id][base];
                    } else {
                        // Рахуємо курс валюти відносно бази через USDT міст
                        price = fiatBridge[base] / fiatBridge[a.id];
                    }

                    // Вивід на екран
                    const el = document.getElementById(`prc-${a.id}`);
                    if(el) {
                        el.innerText = price.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 4});
                        
                        // Оновлюємо графік
                        const chart = charts[a.id];
                        if(chart) {
                            chart.data.datasets[0].data.push(price);
                            if(chart.data.datasets[0].data.length > 15) chart.data.datasets[0].data.shift();
                            chart.update('none');
                        }
                    }
                });
            } catch(e) { console.log("Стримування API..."); }
        }

        function resetAndRefresh() {
            // Очищуємо все при зміні валюти
            initCards();
            update();
        }

        // Запуск
        initCards();
        update();
        setInterval(update, 3000);
    </script>
</body>
</html>
