<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZENITH | Live Terminal</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #050608; --accent: #00ff88; --border: rgba(0, 255, 136, 0.15); }
        body { background: var(--bg); color: white; font-family: 'JetBrains Mono', monospace; margin: 0; padding-bottom: 50px; }
        
        .top-nav {
            position: sticky; top: 0; background: rgba(5, 6, 8, 0.9);
            backdrop-filter: blur(15px); padding: 15px 25px;
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid var(--border); z-index: 100;
        }

        .select-ui {
            background: #000; color: var(--accent); border: 1px solid var(--accent);
            padding: 8px; border-radius: 5px; font-family: inherit;
        }

        .container { max-width: 1100px; margin: auto; padding: 30px 20px; }
        
        .market-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px;
        }

        .card {
            background: rgba(255,255,255,0.02); border: 1px solid var(--border);
            border-radius: 15px; padding: 20px; position: relative;
        }

        .price-text { font-size: 24px; font-weight: bold; margin: 10px 0; color: #fff; }
        .change { font-size: 12px; }
        
        canvas { max-height: 100px; margin-top: 15px; }

        .converter {
            margin-top: 50px; background: rgba(0, 255, 136, 0.03);
            border: 1px dashed var(--accent); border-radius: 20px; padding: 30px;
            text-align: center;
        }

        input {
            background: #000; border: 1px solid var(--border); color: white;
            padding: 12px; border-radius: 8px; font-family: inherit; width: 150px; text-align: center;
        }

        .pulse-dot {
            width: 8px; height: 8px; background: var(--accent); border-radius: 50%;
            display: inline-block; margin-right: 10px; box-shadow: 0 0 10px var(--accent);
            animation: blink 1s infinite;
        }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
    </style>
</head>
<body>

    <div class="top-nav">
        <div style="font-weight:bold; letter-spacing:2px;">ZENITH<span>.SYSTEM</span></div>
        <div>
            <span style="font-size:10px; color:#666;">CURRENCY:</span>
            <select id="baseCurr" class="select-ui" onchange="resetAll()">
                <option value="usd">USD $</option>
                <option value="uah">UAH ₴</option>
                <option value="eur">EUR €</option>
                <option value="rub">RUB ₽</option>
            </select>
        </div>
    </div>

    <div class="container">
        <div style="margin-bottom:30px;">
            <div class="pulse-dot"></div>
            <span style="font-size:11px; color:var(--accent);">REAL-TIME DATA FEED (3s)</span>
        </div>

        <div class="market-grid" id="grid">
            </div>

        <div class="converter">
            <h3>⚡ QUICK CONVERTER</h3>
            <div style="display:flex; justify-content:center; align-items:center; gap:15px; flex-wrap:wrap;">
                <input type="number" id="convAmount" value="1000" oninput="convert()">
                <span id="convLabel">UAH</span>
                <span>➜</span>
                <div id="convResult" style="font-weight:bold; color:var(--accent);">0.00 BTC</div>
            </div>
        </div>
    </div>

    <script>
        const coins = ['bitcoin', 'ethereum', 'solana', 'dogecoin'];
        const charts = {};
        let currentPrices = {};

        function initCards() {
            const grid = document.getElementById('grid');
            grid.innerHTML = coins.map(id => `
                <div class="card">
                    <div style="display:flex; justify-content:space-between;">
                        <span style="color:#888; font-size:12px;">${id.toUpperCase()}</span>
                        <span id="chg-${id}" class="change">0.00%</span>
                    </div>
                    <div id="prc-${id}" class="price-text">0.00</div>
                    <canvas id="chart-${id}"></canvas>
                </div>
            `).join('');

            coins.forEach(id => {
                const ctx = document.getElementById(`chart-${id}`).getContext('2d');
                charts[id] = new Chart(ctx, {
                    type: 'line',
                    data: { labels: Array(20).fill(''), datasets: [{ 
                        data: [], borderColor: '#00ff88', borderWidth: 2, tension: 0.4, pointRadius: 0 
                    }]},
                    options: { plugins: { legend: { display: false } }, scales: { x: { display: false }, y: { display: false } } }
                });
            });
        }

        async function update() {
            const base = document.getElementById('baseCurr').value;
            try {
                const res = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${coins.join(',')}&vs_currencies=${base}&include_24hr_change=true`);
                const data = await res.json();

                coins.forEach(id => {
                    const price = data[id][base];
                    const change = data[id][`${base}_24hr_change`];
                    
                    currentPrices[id] = price;
                    
                    // Оновлюємо текст (до копійок)
                    document.getElementById(`prc-${id}`).innerText = price.toLocaleString(undefined, {minimumFractionDigits: 2});
                    const chgEl = document.getElementById(`chg-${id}`);
                    chgEl.innerText = (change >= 0 ? '+' : '') + change.toFixed(2) + '%';
                    chgEl.style.color = change >= 0 ? '#00ff88' : '#ff4444';

                    // Оновлюємо графік
                    const chart = charts[id];
                    chart.data.datasets[0].data.push(price);
                    if(chart.data.datasets[0].data.length > 20) chart.data.datasets[0].data.shift();
                    chart.update('none');
                });
                convert();
            } catch(e) { console.log("API limit"); }
        }

        function convert() {
            const amt = document.getElementById('convAmount').value;
            const btcPrice = currentPrices['bitcoin'] || 1;
            document.getElementById('convResult').innerText = (amt / btcPrice).toFixed(6) + " BTC";
            document.getElementById('convLabel').innerText = document.getElementById('baseCurr').value.toUpperCase();
        }

        function resetAll() {
            Object.values(charts).forEach(c => { c.data.datasets[0].data = []; c.update(); });
            update();
        }

        initCards();
        update();
        setInterval(update, 3000); // Оновлення кожні 3 секунди
    </script>
</body>
</html>
